---
layout: post
title: "TFG: Automatizaci√≥n de la mitigaci√≥n de vulnerabilidades mediante OpenVAS y modelos de lenguaje"
date: 2026-1-23
---

**[Enlace de descarga de mi trabajo de fin de grado (PDF)](</archivos_posts/TFG>)**

Este Trabajo de Fin de Grado presenta una soluci√≥n integral para el ciclo de vida de vulnerabilidades en entornos internos, resolviendo la brecha operativa entre la detecci√≥n mediante **OpenVAS** y la respuesta activa a trav√©s de agentes basados en **Large Language Models (LLMs)**.

## Arquitectura implementada para el sistema

![Foto de la arquitectura del TFG](/img/TFG_1.png)

El sistema se basa en un pipeline orquestado en Bash y Python que segmenta la operaci√≥n en cuatro capas l√≥gicas:

1. **Capa de Escaneo:** Despliegue de contenedores Docker con el motor de Greenbone (OpenVAS) para la auditor√≠a de activos mediante protocolos NVTs.
2. **Capa de Procesamiento:** Un motor de parsing en Python extrae los resultados en XML/GSRV y los estructura en objetos JSON normalizados, filtrando por severidad (CVSS > 7.0).

![Foto de la capa de procesamiento](/img/TFG_2.png)

3. **Capa de Inteligencia (LLM):** Integraci√≥n con la API de OpenAI utilizando el modelo `gpt-5-mini`. Se emplea un dise√±o de *System Prompt* estricto para la generaci√≥n de scripts de mitigaci√≥n deterministas e idempotentes.

![Foto de la capa de inteligencia](/img/TFG_3.png)

4. **Capa de Ejecuci√≥n:** Implementaci√≥n de los scripts mediante SSH en los targets, asegurando la persistencia de logs y la reversibilidad de los cambios.

![Foto de la capa de ejecuci√≥n](/img/TFG_4.png)

## üõ†Ô∏è Recursos software usados

- **Orquestaci√≥n:** Bash (Pipeline principal)
- **Lenguaje:** Python 3.10+
- **Escaneado:** Greenbone Vulnerability Manager (OpenVAS)
- **IA:** OpenAI API (GPT-5-mini)
- **UI/UX:** Charm (Gum & Rich) para una interfaz de terminal interactiva.
- **Entorno:** Docker & VMware Workstation Pro.

## Prompt Engineering

A diferencia de las soluciones de parcheado gen√©rico, este agente genera **mitigaciones quir√∫rgicas** mediante un completo *prompt engineering*.

* **Idempotencia:** Los scripts verifican el estado del sistema antes de aplicar cambios (e.g., comprobaci√≥n de reglas existentes en `iptables`).
* **Seguridad Operativa:** El flujo de trabajo garantiza el acceso administrativo (SSH) antes de cerrar puertos maliciosos para evitar el auto-bloqueo (*lockout*).
* **An√°lisis Multivariable:** El modelo no solo atiende al ID de la vulnerabilidad, sino que correlaciona el puerto, el servicio detectado y el impacto potencial descrito en el JSON.

## M√©tricas de rendimiento obtenidas 

Durante las pruebas en entornos controlados (*Metasploitable 2*), el sistema arroj√≥ los siguientes resultados:

| M√©trica | Resultado |
| :--- | :--- |
| **Total Vulnerabilidades** | 100 (Simuladas/Detectadas) |
| **Tasa de √âxito de Ejecuci√≥n (TEE)** | 93.93% |
| **Tiempo de Generaci√≥n Medio por Script** | ~5.5 segundos |

## Conclusiones T√©cnicas üìù

El proyecto demuestra que la integraci√≥n de LLMs en flujos de DevSecOps permite democratizar la respuesta ante incidentes para infraestructuras que no pueden costear soluciones como Tenable.io o Qualys, reduciendo el tiempo de exposici√≥n (MTTR) de d√≠as a minutos.

En el caso de a alguien le resulte de inter√©s mi Trabajo de Fin de Grado y quiera echarle un vistazo m√°s en profundidad, dejo el link de descarga **[aqu√≠ (PDF)](</archivos_posts/TFG>)**.

---
**Desarrollado por Daniel Barbeyto Torres. Dirigido por Adri√°n Carballal Mato.** *Graduado en Ingenier√≠a Inform√°tica - Universidad de La Coru√±a (UDC)*

